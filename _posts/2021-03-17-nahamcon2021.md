---
title: NahamCon CTF 2021
categories: [ctf]
comments: false
---

Recently my CTF team, TeamIDKFA took part in the NahamCon2021 CTF. We've done a couple of CTFs by John Hammond before and they're always really good experiences. Well thought out challenges, accurate difficulty levels and usually something for everyone. We did pretty well too, finishing 17th on the leaderboard. Along the way, we got three first bloods, that is to say, we were the first team to solve those three challenges. Competing to get First Blood on a challenge is always an interesting and worthwhile experience and had us all very excited when we managed it not just once, but three times! One of those first bloods specifically belonged to me, so I wanted to write up here how I solved that challenge. 

The challenge was called NASCAR and revolved around the CAN bus of a car:

insert image

This is very similar to a challenge that was on the (insert link)[2020 SANS Holiday Hack challenge], where an attacker had taken control of Santa's sleigh and you needed to solve it. The CAN bus is a message bus present in all modern cars. Various components of the car send and receive messages to control their functions, eg, open doors, apply brakes, increase acceleration etc. There are various dialects of these messages, so what might be the brakes on one car could be the accelerator on another. It is therefore important to understand which dialect you're working with. 

Thankfully this challenge supplies a dump file of some recent messages so we can see what we're dealing with:

insert image

Thankfully, this seems to be the same dialect as that used in the SANS Holiday Hack challenge, so we already have a headstart. From that particular challenge, we identified the following table to show which messages relate to which car functions:

insert image

Therefore setting the brakes is a simple case of reusing the 19Bxxxxxx message: 

insert image

The next question is slightly more tricky. The value of the accelerator isn't easy to spot as it's a hex number at the end of the string. In order to do this, we referred to an excellent blog post from @Spookphia, who talks about using a CAN simulator to watch messages on the CAN bus. Following the instructions in her (link)[blog post], we managed to get the CAN simulator running: 

insert image

Using this simulator, we can use normal controls to try and reach 40 mph by simply pressing the up button. The problem is, just pressing up to increase the speed is one thing - as soon as you stop pressing up, the speed decreases again. So in order to get the correct answer, we came up with a very simple hack. We could see that 40mph was somewhere around XXX, so we ran a bash shell while loop telling the speedometer to stick at that speed. This made it easy to see if it was 40 mph or not. If it wasn't, we just incremented the number and tried again. Following this process eventually got us to the answer, which was: XXXXX

insert image

This allowed us to get the flag and score a first blood on this challenge :) 
